<html>
  <head>
    <title>Socket.IO chat</title>
  </head>
  <body>
    <div id="main">
        
    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script>
        var userID;
        loginandsetup();
        function loginandsetup(){            
            $loginnameinput = document.createElement("input");
            $loginnameinput.style = "width: 100px; height: 20px;";
            $loginnameinput.id = "loginusername";
            $loginnameinput.placeholder = "username";
            
            $loginpassinput = document.createElement("input");
            $loginpassinput.style = "width: 100px; height: 20px;";
            $loginpassinput.id = "loginpassword";
            $loginpassinput.placeholder = "password";
            
            $loginbutton = document.createElement("button");
            $loginbutton.style = "width: 100px; height: 20px;";
            $loginbutton.id = "loginsubmit";
            $loginbutton.append("login");
            
            $('#main').append("login"+"<br>");
            $('#main').append($loginnameinput);
            $('#main').append($loginpassinput);
            $('#main').append($loginbutton);
        }
        
        function clear(){
            $("#main").empty();
        }
        
        function usersite(name){
            $chatnameinput = document.createElement("input");
            $chatnameinput.style = "width: 100px; height: 20px;";
            $chatnameinput.id = "chatname";
            $chatnameinput.placeholder = "username";
            
            $chatbutton = document.createElement("button");
            $chatbutton.style = "width: 100px; height: 20px;";
            $chatbutton.id = "chatsubmit";
            $chatbutton.append("Create Chat");
            
            $('#main').append("hi: " + name +"<br>");
            $('#main').append("CreateChat"+"<br>");
            $('#main').append($chatnameinput);
            $('#main').append($chatbutton);
        }
        
        //$(function () {
            var socket = io();
            
            $('#loginsubmit').click(function(e){
                e.preventDefault(); // prevents page reloading
                socket.emit('login', $('#loginusername').val(),$('#loginpassword').val());
                return false;
            });
            
            $('#chatsubmit').click(function(e){
                console.log("button pressed");
                e.preventDefault(); // prevents page reloading
                //socket.emit('createchat', $('#chatname').val(),userID);
                var data = {
                    x: 'hi',
                    y: 'there'
                }
                socket.emit('createchat', data);
                return false;
            });
            
            socket.on('login', function(msg,ID,name){
                if(msg){
                    userID = ID;
                    clear();
                    usersite(name);
                    socket.emit('chatquery', userID);
                }
            });
            socket.on('errormsg', function(msg){
                alert(msg);
            });
        //});
    </script>
  </body>
</html>